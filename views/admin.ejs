<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/style.css" type="text/css">
    <title>SPC</title>
</head>
<body>
    <div class="header">
        <div class="row header-row">
            <div class="col-sm-12 col-md-4 logo">
                <a href="/"><img src="./images/spc-logo-png-1.png"></a>
            </div>
            <div class="col-sm-12 col-md-8 menu">
                <div class="row">
                    <div class="col-sm-12 col-md-3 menu-item_div">
                        <a class="menu-item" href="/">Dashboard</a>
                    </div>
                    <div class="col-sm-12 col-md-3 menu-item_div">
                        <a class="menu-item" href="./myaccount.php">My Account</a>
                    </div>
                    <div class="col-sm-12 col-md-3 menu-item_div">
                        <a class="menu-item" href="#">Logout</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mobile-menu">
            <!--Navbar-->
            <nav class="navbar navbar-light light-blue lighten-4">

                <!-- Navbar brand -->
                <a class="navbar-brand" href="/"><img src="./images/spc-logo-png-1.png"></a>

                <!-- Collapse button -->
                <button class="navbar-toggler toggler-example" type="button" data-toggle="collapse" data-target="#navbarSupportedContent1"
                aria-controls="navbarSupportedContent1" aria-expanded="false" aria-label="Toggle navigation"><span class="dark-blue-text"><i
                    class="fas fa-bars fa-1x"></i></span></button>

                <!-- Collapsible content -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent1">

                <!-- Links -->
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                    <a class="menu-item" href="/">Dashboard</a>
                    </li>
                    <li class="nav-item">
                    <a class="menu-item" href="./myaccount.php">My Account</a>
                    </li>
                    <li class="nav-item">
                    <a class="menu-item" href="#">Logout</a>
                    </li>
                </ul>
                <!-- Links -->

                </div>
                <!-- Collapsible content -->

            </nav>
            <!--/.Navbar-->
        </div>
    </div>
    <div class="content">
        <div class="container">
            <div class="row container-row">
                <div class="col-sm-12 col-md-2">
                </div>
                <div class="col-sm-12 col-md-8">
                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="parts-add-tab" data-toggle="pill" href="#parts-add" role="tab" aria-controls="parts-add" aria-selected="true">Add Parts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="users-info-tab" data-toggle="pill" href="#users-info" role="tab" aria-controls="users-info" aria-selected="false">User Info</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="parts-tabContent">
                        <div class="tab-pane fade show active" id="parts-add" role="tabpanel" aria-labelledby="parts-add-tab">
                
                                <div class="row addparts-rows">
                                    <div class="col-md-4">
                                        <label for="technology">Choose a Technology:</label>
                                    </div>
                                    <div class="col-md-4 entrybox">
                                        <select id="technology-add-parts" onchange="load_machines(this)" name="technologyaddlist" form="technologyaddform">
                                        </select>
                                    </div>
                                    <div class="col-md-4 addnew">
                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addnewtech" data-whatever="@mdo">Add New</button>                                        
                                        <div class="modal fade" id="addnewtech" tabindex="-1" role="dialog" aria-labelledby="addnewtechLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addnewtechLabel">Add New Technology</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form>
                                                    <div class="form-group">
                                                        <label for="technology-name" class="col-form-label">Name:</label>
                                                        <input type="text" class="form-control" id="new-technology-name">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="tech-image" class="col-form-label">Image:</label>
                                                        <input type="file" class="form-control" id="new-tech-image">
                                                    </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" onclick="add_technology()" class="btn btn-primary">Save</button>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row addparts-rows" id="machine-container" style="display:none;">
                                    <div class="col-md-4">
                                        <label for="machine">Choose a Machine:</label>
                                    </div>
                                    <div class="col-md-4 entrybox">
                                        <select id="machine-add-parts" style="display:none;" onchange="load_part(this)" name="machineaddlist" form="machineaddform">
                                        </select>
                                    </div>
                                    <div class="col-md-4 addnew">
                                        <button type="button" id="new-machine-btn" style="display:none;" class="btn btn-primary" data-toggle="modal" data-target="#addnewmachine" data-whatever="@mdo">Add New</button>                                        
                                        <div class="modal fade" id="addnewmachine" tabindex="-1" role="dialog" aria-labelledby="addnewmachineLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addnewmachineLabel">Add New Machine</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form>
                                                    <div class="form-group">
                                                        <label for="machine-name" class="col-form-label">Name:</label>
                                                        <input type="text" class="form-control" id="new-machine-name">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="machine-image" class="col-form-label">Image:</label>
                                                        <input type="file" class="form-control" id="new-machine-image">
                                                    </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" onclick="add_machine()" class="btn btn-primary">Save</button>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row addparts-rows" id="assembly-container" style="display:none;">
                                    <div class="col-md-4">
                                        <label for="assembly">Choose a Assembly:</label>
                                    </div>
                                    <div class="col-md-4 entrybox">
                                        <select id="assembly-add-parts" onchange="load_part(this)" style="display:none;" name="assemblyaddlist" form="assemblyaddform">
                                        </select>
                                    </div>
                                    <div class="col-md-4 addnew">
                                        <button type="button" id="new-assembly-btn" style="display:none;"class="btn btn-primary" data-toggle="modal" data-target="#addnewassembly" data-whatever="@mdo">Add New</button>                                        
                                        <div class="modal fade" id="addnewassembly" tabindex="-1" role="dialog" aria-labelledby="addnewassemblyLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addnewmachineLabel">Add New Assembly</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form>
                                                    <div class="form-group">
                                                        <label for="assembly-name" class="col-form-label">Name:</label>
                                                        <input type="text" class="form-control" id="new-assembly-name">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="assembly-image" class="col-form-label">Image:</label>
                                                        <input type="file" class="form-control" id="new-assembly-image">
                                                    </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" onclick="add_assembly()" class="btn btn-primary">Save</button>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row addparts-rows" id="part-container" style="display:none;">
                                    <div class="col-md-4">
                                        <label for="parts">Choose Part</label>
                                    </div>
                                    <div class="col-md-4 addnew">
                                        <button type="button" id="new-part-btn" style="display:none;" class="btn btn-primary" data-toggle="modal" data-target="#addnewpart" data-whatever="@mdo">Add New</button>                                        
                                        <div class="modal fade" id="addnewpart" tabindex="-1" role="dialog" aria-labelledby="addnewpartLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="addnewpartLabel">Add New Part</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form>
                                                        <div class="form-group">
                                                            <label for="part-code" class="col-form-label">SAP Code:</label>
                                                            <input type="text" class="form-control" id="new-sap-code">
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="part-name" class="col-form-label">Name:</label>
                                                            <input type="text" class="form-control" id="new-part-name">
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="part-returnable" class="col-form-label">Returnable:</label><br>
                                                            <label><input type="checkbox" id="new-part-check"> "If returnale box should be checked"</label>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="part-image" class="col-form-label">Image:</label>
                                                            <input type="file" class="form-control" id="new-part-image">
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" onclick="add_part()" class="btn btn-primary">Save</button>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                    
                        </div>
                        <div class="tab-pane fade" id="users-info" role="tabpanel" aria-labelledby="users-info-tab">
                            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="registered-users-tab" data-toggle="pill" href="#registered-users" role="tab" aria-controls="registered-users" aria-selected="true">Registered Users</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="requsted-users-tab" data-toggle="pill" href="#requsted-users" role="tab" aria-controls="requsted-users" aria-selected="false">Requested Users</a>
                                </li>
                            </ul>
                            <div class="tab-content" id="users-tabContent">
                                <div class="tab-pane fade" id="requsted-users" role="tabpanel" aria-labelledby="requsted-users-tab">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-striped">
                                            <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Mobile</th>
                                                <th>Approve/Reject</th>
                                            </tr>
                                            </thead>
                                            <tbody id="myTable">
                                            <tr>
                                                <td>User Singh</td>
                                                <td>user@gmail.com</td>
                                                <td>1234567890</td>
                                                <td  class="requested-users-tr"><button type="button" class="btn btn-success">Approve</button><button type="button" class="btn btn-danger">Reject</button></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="tab-pane fade show active" id="registered-users" role="tabpanel" aria-labelledby="registered-users-tab">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-striped">
                                            <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Mobile</th>
                                            </tr>
                                            </thead>
                                            <tbody id="myTable">
                                            <tr>
                                                <td>User Singh</td>
                                                <td>user@gmail.com</td>
                                                <td>1234567890</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-2">
                </div>
            </div>
        </div>
    </div>
    <div class="footer"></div>
    
<script>
$(document).ready(function(){
    $("#myInput").on("keyup", function() {
        var value = $(this).val().toLowerCase();
        $("#myTable tr").filter(function() {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    });
});
</script>

<script>
    $(document).ready(function(){
        $("#myInput_2").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function() {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
</script>

<script>
    $(document).ready(function(){
        $.get('/api/all-technology').done( data => {
             
             let techs = '<option value="0">-- select technology --</option>';
             data.forEach( tech => {
                 techs += '<option value="' + tech.id + '">' + tech.name + '</option>';
             });
             $('#technology-add-parts').html(techs);
        });
    });
    
    
    function load_machines(e){
        $('#machine-add-parts').hide();
        $('#new-machine-btn').hide();
        $('#machine-container').hide();
        
        $('#assembly-add-parts').hide();
        $('#new-assembly-btn').hide();
        $('#assembly-container').hide();
        
        $('#new-part-btn').hide();
        $('#part-container').hide();
        
        if(e.value != '0'){
            $.post('api/machine' , { technologyId : e.value })
            .done(data => {
                let machines = '<option value="0">-- select machine --</option>';
                data.forEach(machine => {
                    machines += '<option value="' + machine.id + '">' + machine.name + '</option>';
                });
                $('#machine-add-parts').html(machines);
                $('#machine-add-parts').show();
                $('#new-machine-btn').show();
                $('#machine-container').show();
            });
        }
    }
    
    function load_assembly(e){
        $('#assembly-add-parts').hide();
        $('#new-assembly-btn').hide();
        $('#assembly-container').hide();
        
        $('#new-part-btn').hide();
        $('#part-container').hide();
        
        if(e.value != '0'){
            $.post('api/assembly' , { machineID : e.value })
            .done(data => {
                let assemblies = '<option value="0">-- select assembly --</option>';
                data.forEach(assembly => {
                    assemblies += '<option value="' + assembly.id + '">' + assembly.name + '</option>';
                });
                $('#assembly-add-parts').html(assemblies);
                $('#assembly-add-parts').show();
                $('#new-assembly-btn').show();
                $('#assembly-container').show();
            });
        }
    }
    
    function load_part(e){
         $('#new-part-btn').hide();
        $('#part-container').hide();
        
        if(e.value != '0'){ 
            $('#new-part-btn').show();
        $('#part-container').show();
        }
    }
    
    function add_technology(){
        let name = $('#new-technology-name').val();
        $.post('api/add-technology' , { name : name })
        .done( data => {
            if(data.status == 'success'){
                $.get('/api/all-technology').done( data => {
             
                    let techs = '<option value="0">-- select technology --</option>';
                    data.forEach( tech => {
                        techs += '<option value="' + tech.id + '">' + tech.name + '</option>';
                    });
                    $('#technology-add-parts').html(techs);
                     
                     load_machines($('#technology-add-parts'));
                    $('#addnewtech').modal('hide');
                });
            }else{
                alert( 'Faild to create technology');
            }
            
        });
    }
    
    function add_machine(){
        let name = $('#new-machine-name').val();
        let technologyID = $('#technology-add-parts').val();
        let technology_select = document.getElementById('technology-add-parts');
        $.post('api/add-machine' , { name : name , technologyID : technologyID})
        .done( data => {
            if(data.status == 'success'){
                load_machines( technology_select );
                $('#addnewmachine').modal('hide');
            }else{
                alert( 'Faild to create technology');
            }
            
        });
    }
    
    function add_assembly(){
        let name = $('#new-assembly-name').val();
        let machineID = $('#machine-add-parts').val();
        let machine_select = document.getElementById('machine-add-parts');
        $.post('api/add-assembly' , { name : name , machineID : machineID})
        .done( data => {
            if(data.status == 'success'){
                load_assembly( machine_select );
                $('#addnewassembly').modal('hide');
            }else{
                alert( 'Faild to create assembly');
            }
            
        });
    } 
    
    function add_part(){
        let name = $('#new-part-name').val();
        let sapcode = $('#new-sap-code').val();
        let returnable = $('#new-part-check').prop('checked');
        let machineID = $('#machine-add-parts').val();
        let machine_select = document.getElementById('machine-add-parts');
        $.post('api/add-part' , { name : name , sapcode : sapcode , returnable : returnable , machineID : machineID})
        .done( data => {
            if(data.status == 'success'){
                load_part( machine_select );
                $('#addnewpart').modal('hide');
            }else{
                alert( 'Faild to create assembly');
            }
            
        });
    }
</script>

</div>
</body>
</html>